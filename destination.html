<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Destination | Wanderly</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }
        
        body {
            background-color: #f8f9fa;
        }
        
        .navbar {
            display: flex;
            align-items: center;
            background-color: #5e9ced;
            padding: 1rem 2rem;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            justify-content: space-between;
        }
        
        .hero {
            height: 70vh;
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            text-align: center;
            padding-top: 70px;
            position: relative;
            overflow: hidden;
        }
        
        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.6));
            z-index: 1;
        }
        
        .hero-content {
            position: relative;
            z-index: 2;
            max-width: 800px;
            padding: 0 20px;
        }
        
        .hero h1 {
            font-size: 4rem;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            animation: fadeInUp 1s ease;
        }
        
        .hero p {
            font-size: 1.8rem;
            margin: 0 auto;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
            animation: fadeInUp 1.2s ease;
        }
        
        .quick-info {
            display: flex;
            justify-content: space-around;
            padding: 2rem;
            background: white;
            margin: -50px auto 0;
            max-width: 1000px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            position: relative;
            z-index: 2;
        }
        
        .info-item {
            text-align: center;
            padding: 1rem;
        }
        
        .info-item i {
            font-size: 2rem;
            color: #5e9ced;
            margin-bottom: 1rem;
        }
        
        .content {
            max-width: 1200px;
            margin: 40px auto;
            padding: 0 20px;
        }
        
        .section {
            margin-bottom: 60px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.6s ease;
        }
        
        .section.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .section h2 {
            font-size: 2.5rem;
            color: #333;
            margin-bottom: 30px;
            text-align: center;
            position: relative;
        }
        
        .section h2::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 3px;
            background: #5e9ced;
        }
        
        .highlights {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }
        
        .highlight-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            position: relative;
        }
        
        .highlight-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }
        
        .highlight-card img {
            width: 100%;
            height: 250px;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
        
        .highlight-card:hover img {
            transform: scale(1.1);
        }
        
        .highlight-card .content {
            padding: 20px;
            margin: 0;
        }
        
        .highlight-card h3 {
            font-size: 1.5rem;
            color: #333;
            margin-bottom: 10px;
        }
        
        .highlight-card p {
            color: #666;
            line-height: 1.6;
        }
        
        .blogs-section {
            background: #f8f9fa;
            padding: 60px 0;
        }
        
        .blog-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }
        
        .blog-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        
        .blog-card:hover {
            transform: translateY(-10px);
        }
        
        .blog-image {
            height: 200px;
            overflow: hidden;
        }
        
        .blog-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
        
        .blog-card:hover .blog-image img {
            transform: scale(1.1);
        }
        
        .blog-content {
            padding: 20px;
        }
        
        .blog-meta {
            display: flex;
            justify-content: space-between;
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }
        
        .add-blog-btn {
            display: inline-block;
            padding: 15px 30px;
            background: #5e9ced;
            color: white;
            text-decoration: none;
            border-radius: 30px;
            font-weight: 500;
            margin-top: 30px;
            transition: all 0.3s ease;
        }
        
        .add-blog-btn:hover {
            background: #4a7fc7;
            transform: translateY(-3px);
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            position: relative;
        }
        
        .close-modal {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 1.5rem;
            cursor: pointer;
            color: #333;
        }
        
        .blog-form input,
        .blog-form textarea {
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }
        
        .blog-form button {
            background: #5e9ced;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .blog-form button:hover {
            background: #4a7fc7;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2.5rem;
            }
            .hero p {
                font-size: 1.2rem;
            }
            .quick-info {
                flex-wrap: wrap;
            }
            .info-item {
                width: 50%;
            }
        }
        
        .blog-content p {
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
        }
        
        .read-more-btn {
            color: #5e9ced;
            text-decoration: none;
            font-weight: 500;
            display: inline-block;
            margin-top: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .read-more-btn:hover {
            color: #4a7fc7;
            text-decoration: underline;
        }
        
        .blog-photos {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }
        
        .blog-photos img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        
        .blog-photos img:hover {
            transform: scale(1.05);
        }
        
        .blog-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1100;
            padding: 20px;
            overflow-y: auto;
        }
        
        .blog-modal-content {
            background: white;
            max-width: 800px;
            margin: 50px auto;
            padding: 30px;
            border-radius: 15px;
            position: relative;
        }
        
        .photo-upload-container {
            margin: 15px 0;
            border: 2px dashed #5e9ced;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        
        .photo-preview {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }
        
        .photo-preview img {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: 5px;
        }
        
        .remove-photo {
            position: absolute;
            top: -8px;
            right: -8px;
            background: red;
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .action-btn {
            padding: 5px 10px;
            margin-right: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }
        
        .edit-btn {
            background: #5e9ced;
            color: white;
        }
        
        .edit-btn:hover {
            background: #4a7fc7;
        }
        
        .delete-btn {
            background: #ff4444;
            color: white;
        }
        
        .delete-btn:hover {
            background: #cc0000;
        }
        
        .blog-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }
    </style>
</head>

<body>
    <div id="loading">
        <div class="spinner"></div>
    </div>

    <nav class="navbar">
        <!-- Logo on the Left -->
        <div style="display: flex; align-items: center; flex-shrink: 0;">
            <div><img src="logo.png" style="height: 40px; width: 40px; border-radius: 50%; margin-right: 10px;"></div>
            <span><img style="width:100px; height:auto;" src="wanderly.png"></span>
        </div>

        <!-- Navigation Links -->
        <div style="display: flex; gap: 2rem; flex-grow: 1; justify-content: center;">
            <a href="main2.html" style="color: white; text-decoration: none; font-weight: 500; transition: all 0.3s ease;">HOME</a>
            <a href="Chennai.html" style="color: white; text-decoration: none; font-weight: 500; transition: all 0.3s ease;">TRAVEL</a>
            <a href="flights.html" style="color: white; text-decoration: none; font-weight: 500; transition: all 0.3s ease;">FLIGHTS</a>
            <a href="#" style="color: white; text-decoration: none; font-weight: 500; transition: all 0.3s ease;">CONTACT</a>
        </div>

        <!-- Login/Signup Button -->
        <div style="flex-shrink: 0;">
            <div id="authButton">
                <a href="signup.html"><button style="background-color: white; color: #1a73e8; border: none; padding: 10px 15px; border-radius: 4px; font-size: 14px; cursor: pointer; transition: background-color 0.3s ease; font-weight: bold;">
                    Login / Signup
                </button></a>
            </div>
        </div>
    </nav>

    <div id="destination-content"></div>

    <div id="weatherWidget"></div>

    <div class="modal" id="imageModal">
        <span class="close-modal">&times;</span>
        <img src="" alt="" id="modalImage">
    </div>

    <!-- Add Blog Modal -->
    <div class="modal" id="blogModal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Share Your Experience</h2>
            <form class="blog-form" id="blogForm">
                <input type="text" placeholder="Title" required>
                <textarea placeholder="Share your experience..." rows="6" required></textarea>
                <div class="photo-upload-container">
                    <label for="photos">Add Photos (Multiple photos allowed)</label>
                    <input type="file" id="photos" accept="image/*" multiple>
                    <div class="photo-preview" id="photoPreview"></div>
                </div>
                <button type="submit">Post Blog</button>
            </form>
        </div>
    </div>

    <!-- Add Blog Modal Template -->
    <div class="blog-modal" id="fullBlogModal">
        <div class="blog-modal-content">
            <span class="close-modal">&times;</span>
            <div id="fullBlogContent"></div>
        </div>
    </div>

    <script>
        // City data configuration
        const cityData = {
            paris: {
                title: "Paris, France",
                tagline: "Experience the magic of the City of Light",
                heroImage: 'paris.gif',
                info: {
                    population: "2.2 million",
                    language: "French",
                    currency: "Euro (€)",
                    timezone: "CET (UTC+1)"
                },
                about: "Paris, the capital of France, is renowned worldwide for its art, culture, fashion, and gastronomy. From the iconic Eiffel Tower to the historic Notre-Dame Cathedral, every corner of Paris tells a story of romance, history, and artistic excellence.",
                attractions: [{
                    name: "Eiffel Tower",
                    description: "The most iconic symbol of Paris, offering breathtaking views of the city.",
                    image: "eiffel.jpg"
                }, {
                    name: "Louvre Museum",
                    description: "Home to thousands of works of art, including the famous Mona Lisa.",
                    image: "louvre.jpg"
                }, {
                    name: "Notre-Dame Cathedral",
                    description: "A masterpiece of French Gothic architecture.",
                    image: "notre-dame.jpg"
                }],
                experiences: [{
                    name: "Parisian Cafés",
                    description: "Experience the charm of authentic French café culture.",
                    image: "cafe.jpg"
                }, {
                    name: "Seine River Cruise",
                    description: "See Paris from a different perspective on a river cruise.",
                    image: "seine.jpg"
                }, {
                    name: "Montmartre",
                    description: "Explore the artistic heart of Paris.",
                    image: "montmartre.jpg"
                }]
            },
            newyork: {
                title: "New York City, USA",
                tagline: "The City That Never Sleeps",
                heroImage: 'newyork.gif',
                info: {
                    population: "8.4 million",
                    language: "English",
                    currency: "US Dollar ($)",
                    timezone: "EST (UTC-5)"
                },
                about: "New York City is a global metropolis known for its iconic skyline, diverse culture, and endless opportunities for entertainment, dining, and shopping.",
                attractions: [{
                    name: "Times Square",
                    description: "The bright lights and energy of NYC's most famous intersection.",
                    image: "times-square.jpg"
                }, {
                    name: "Central Park",
                    description: "An oasis of green in the heart of Manhattan.",
                    image: "central-park.jpg"
                }, {
                    name: "Statue of Liberty",
                    description: "America's most iconic symbol of freedom.",
                    image: "liberty.jpg"
                }],
                experiences: [{
                    name: "Broadway Shows",
                    description: "Experience world-class theater performances.",
                    image: "broadway.jpg"
                }, {
                    name: "Food Tours",
                    description: "Taste the diverse culinary offerings of NYC.",
                    image: "food-tour.jpg"
                }, {
                    name: "Museum Visits",
                    description: "Explore world-renowned museums and galleries.",
                    image: "museum.jpg"
                }]
            },
            bali: {
                title: "Bali, Indonesia",
                tagline: "Paradise on Earth",
                heroImage: 'bali.gif',
                info: {
                    population: "4.3 million",
                    language: "Indonesian, Balinese",
                    currency: "Indonesian Rupiah (IDR)",
                    timezone: "WITA (UTC+8)"
                },
                about: "Bali is a tropical paradise known for its lush landscapes, pristine beaches, rich culture, and spiritual atmosphere. From ancient temples to vibrant coral reefs, it offers a unique blend of natural beauty and cultural heritage.",
                attractions: [{
                    name: "Tanah Lot Temple",
                    description: "Ancient sea temple perched on a rocky outcrop.",
                    image: "tanah-lot.jpg"
                }, {
                    name: "Ubud Monkey Forest",
                    description: "Sacred forest home to hundreds of monkeys and ancient temples.",
                    image: "monkey-forest.jpg"
                }, {
                    name: "Rice Terraces",
                    description: "Stunning terraced rice fields in Tegalalang.",
                    image: "rice-terraces.jpg"
                }],
                experiences: [{
                    name: "Yoga Retreats",
                    description: "Find inner peace at world-class yoga retreats.",
                    image: "yoga.jpg"
                }, {
                    name: "Surfing",
                    description: "Catch waves at famous surf spots.",
                    image: "surfing.jpg"
                }, {
                    name: "Temple Tours",
                    description: "Explore ancient Balinese temples and culture.",
                    image: "temples.jpg"
                }]
            },
            capetown: {
                title: "Cape Town, South Africa",
                tagline: "Where Mountains Meet the Ocean",
                heroImage: 'capetown.gif',
                info: {
                    population: "4.6 million",
                    language: "English, Afrikaans, Xhosa",
                    currency: "South African Rand (R)",
                    timezone: "SAST (UTC+2)"
                },
                about: "Cape Town is a stunning coastal city where natural beauty meets rich history and vibrant culture. Nestled between Table Mountain and the Atlantic Ocean, it offers breathtaking landscapes and diverse experiences.",
                attractions: [{
                    name: "Table Mountain",
                    description: "Iconic flat-topped mountain offering panoramic views.",
                    image: "table-mountain.jpg"
                }, {
                    name: "Robben Island",
                    description: "Historic prison island where Nelson Mandela was held.",
                    image: "robben-island.jpg"
                }, {
                    name: "V&A Waterfront",
                    description: "Vibrant harbor with shopping, dining, and entertainment.",
                    image: "waterfront.jpg"
                }],
                experiences: [{
                    name: "Wine Tasting",
                    description: "Experience the Cape Winelands' world-class vineyards.",
                    image: "wine-tasting.jpg"
                }, {
                    name: "Beach Life",
                    description: "Relax on pristine beaches with stunning mountain views.",
                    image: "beaches.jpg"
                }, {
                    name: "Cultural Tours",
                    description: "Explore the rich history and diverse culture.",
                    image: "cultural-tour.jpg"
                }]
            },
            barcelona: {
                title: "Barcelona, Spain",
                tagline: "A City of Art and Architecture",
                heroImage: 'barcelona.gif',
                info: {
                    population: "1.6 million",
                    language: "Spanish, Catalan",
                    currency: "Euro (€)",
                    timezone: "CET (UTC+1)"
                },
                about: "Barcelona is a vibrant city known for its unique architecture, rich culture, and Mediterranean lifestyle. From Gaudi's masterpieces to bustling Las Ramblas, it offers an unforgettable blend of history and modernity.",
                attractions: [{
                    name: "Sagrada Familia",
                    description: "Gaudi's iconic unfinished basilica.",
                    image: "sagrada-familia.jpg"
                }, {
                    name: "Park Güell",
                    description: "Whimsical park featuring Gaudi's creative architecture.",
                    image: "park-guell.jpg"
                }, {
                    name: "Gothic Quarter",
                    description: "Historic district with medieval architecture.",
                    image: "gothic-quarter.jpg"
                }],
                experiences: [{
                    name: "Tapas Tours",
                    description: "Sample traditional Spanish tapas and wines.",
                    image: "tapas.jpg"
                }, {
                    name: "Beach Activities",
                    description: "Enjoy Mediterranean beaches and water sports.",
                    image: "barcelona-beach.jpg"
                }, {
                    name: "Art Museums",
                    description: "Explore world-class art collections.",
                    image: "museums.jpg"
                }]
            },
            tokyo: {
                title: "Tokyo, Japan",
                tagline: "Where Tradition Meets Innovation",
                heroImage: 'kyoto.gif',
                info: {
                    population: "37 million",
                    language: "Japanese",
                    currency: "Japanese Yen (¥)",
                    timezone: "JST (UTC+9)"
                },
                about: "Tokyo is a dynamic metropolis that seamlessly blends ultramodern technology with traditional culture. From ancient temples to futuristic skyscrapers, it offers an incredible array of experiences.",
                attractions: [{
                    name: "Senso-ji Temple",
                    description: "Tokyo's oldest Buddhist temple.",
                    image: "sensoji.jpg"
                }, {
                    name: "Shibuya Crossing",
                    description: "World's busiest pedestrian crossing.",
                    image: "shibuya.jpg"
                }, {
                    name: "Tokyo Skytree",
                    description: "Tallest structure in Japan with observation decks.",
                    image: "skytree.jpg"
                }],
                experiences: [{
                    name: "Food Tours",
                    description: "Explore Japan's incredible culinary scene.",
                    image: "food.jpg"
                }, {
                    name: "Tea Ceremonies",
                    description: "Experience traditional Japanese tea culture.",
                    image: "tea.jpg"
                }, {
                    name: "Technology Districts",
                    description: "Discover the latest in Japanese innovation.",
                    image: "akihabara.jpg"
                }]
            }
        };

        // Function to get URL parameters
        function getUrlParameter(name) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(name);
        }

        // Function to get blogs from localStorage
        function getBlogs(city) {
            const blogs = JSON.parse(localStorage.getItem(`${city}_blogs`)) || [];
            return blogs;
        }

        // Function to save a new blog
        function saveBlog(city, blog) {
            const blogs = getBlogs(city);
            blogs.push({
                ...blog,
                date: new Date().toISOString(),
                id: Date.now()
            });
            localStorage.setItem(`${city}_blogs`, JSON.stringify(blogs));
        }

        // Function to format date
        function formatDate(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diffTime = Math.abs(now - date);
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));

            if (diffDays === 0) return 'Today';
            if (diffDays === 1) return 'Yesterday';
            if (diffDays < 7) return `${diffDays} days ago`;
            return date.toLocaleDateString('en-US', {
                month: 'long',
                day: 'numeric',
                year: 'numeric'
            });
        }

        // Function to check if user is logged in
        function isUserLoggedIn() {
            return localStorage.getItem('isLoggedIn') === 'true';
        }

        // Function to get current user's name
        function getCurrentUserName() {
            return localStorage.getItem('userName') || 'Anonymous';
        }

        // Function to create blog HTML with truncated content
        function createBlogHTML(blog) {
            // Ensure blog.images exists and is an array
            const images = Array.isArray(blog.images) ? blog.images : [];

            const truncatedContent = blog.content.length > 150 ?
                blog.content.substring(0, 150) + '...' :
                blog.content;

            const isCurrentUser = blog.userId === localStorage.getItem('userId');
            const actionButtons = isCurrentUser ? `
                <div class="blog-actions" style="margin-top: 10px;">
                    <button onclick="editBlog(${blog.id})" class="action-btn edit-btn">
                        <i class="fas fa-edit"></i> Edit
                    </button>
                    <button onclick="deleteBlog(${blog.id})" class="action-btn delete-btn">
                        <i class="fas fa-trash"></i> Delete
                    </button>
                </div>
            ` : '';

            return `
                <div class="blog-card" data-id="${blog.id}">
                    <div class="blog-image">
                        <img src="${images.length > 0 ? images[0] : 'default-blog.jpg'}" alt="${blog.title}">
                    </div>
                    <div class="blog-content">
                        <div class="blog-meta">
                            <span><i class="fas fa-user"></i> ${blog.author || 'Anonymous'}</span>
                            <span><i class="fas fa-calendar"></i> ${formatDate(blog.date)}</span>
                        </div>
                        <h3>${blog.title}</h3>
                        <p>${truncatedContent}</p>
                        <a class="read-more-btn" onclick="showFullBlog(${blog.id})">
                            Read More <i class="fas fa-arrow-right"></i>
                        </a>
                        ${actionButtons}
                    </div>
                </div>
            `;
        }

        // Function to show full blog content
        function showFullBlog(blogId) {
            const city = getUrlParameter('city');
            const blogs = getBlogs(city);
            const blog = blogs.find(b => b.id === blogId);

            if (!blog) return;

            // Ensure blog.images exists and is an array
            const images = Array.isArray(blog.images) ? blog.images : [];

            const photosHTML = images.map(img => `
                <img src="${img}" alt="Blog photo" onclick="openImageModal('${img}')">
            `).join('');

            const fullBlogHTML = `
                <h2>${blog.title}</h2>
                <div class="blog-meta">
                    <span><i class="fas fa-user"></i> ${blog.author || 'Anonymous'}</span>
                    <span><i class="fas fa-calendar"></i> ${formatDate(blog.date)}</span>
                </div>
                ${images.length > 0 ? `
                <div class="blog-photos">
                    ${photosHTML}
                </div>
                ` : ''}
                <p style="white-space: pre-line;">${blog.content}</p>
            `;

            document.getElementById('fullBlogContent').innerHTML = fullBlogHTML;
            document.getElementById('fullBlogModal').style.display = 'block';
        }

        // Handle multiple photo uploads
        document.getElementById('photos').addEventListener('change', function(e) {
            const preview = document.getElementById('photoPreview');
            preview.innerHTML = '';
            const files = Array.from(e.target.files);

            files.forEach((file, index) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const imgContainer = document.createElement('div');
                    imgContainer.style.position = 'relative';

                    const img = document.createElement('img');
                    img.src = e.target.result;

                    const removeBtn = document.createElement('button');
                    removeBtn.className = 'remove-photo';
                    removeBtn.innerHTML = '×';
                    removeBtn.onclick = function() {
                        imgContainer.remove();
                    };

                    imgContainer.appendChild(img);
                    imgContainer.appendChild(removeBtn);
                    preview.appendChild(imgContainer);
                };
                reader.readAsDataURL(file);
            });
        });

        // Update blog form submission
        document.getElementById('blogForm').onsubmit = function(e) {
            e.preventDefault();
            const city = getUrlParameter('city');

            if (!isUserLoggedIn()) {
                alert('Please log in to post a blog.');
                return;
            }

            const form = e.target;
            const title = form.querySelector('input[placeholder="Title"]').value;
            const content = form.querySelector('textarea').value;
            const author = getCurrentUserName(); // Get name from logged-in user

            // Get all preview images
            const images = Array.from(document.querySelectorAll('#photoPreview img')).map(img => img.src);

            const blog = {
                title,
                author,
                content,
                images,
                date: new Date().toISOString(),
                id: Date.now(),
                userId: localStorage.getItem('userId') // Store user ID for potential edit/delete functionality
            };

            saveBlog(city, blog);
            loadDestination();
            document.getElementById('blogModal').style.display = 'none';
            form.reset();
            document.getElementById('photoPreview').innerHTML = '';
        };

        // Close modals
        document.querySelectorAll('.close-modal').forEach(btn => {
            btn.onclick = function() {
                document.getElementById('blogModal').style.display = 'none';
                document.getElementById('fullBlogModal').style.display = 'none';
            };
        });

        // Close modals when clicking outside
        window.onclick = function(event) {
            if (event.target.classList.contains('modal') || event.target.classList.contains('blog-modal')) {
                event.target.style.display = 'none';
            }
        };

        // Function to load destination content
        function loadDestination() {
            const city = getUrlParameter('city');
            const data = cityData[city];

            if (!data) {
                document.getElementById('destination-content').innerHTML = '<div class="content"><h1>Destination not found</h1></div>';
                document.getElementById('loading').style.display = 'none';
                return;
            }

            // Get user blogs for this city
            const userBlogs = getBlogs(city);

            // Create blogs HTML
            const blogsHTML = userBlogs.map(blog => createBlogHTML(blog)).join('');

            document.title = `${data.title} | Wanderly`;

            const html = `
                <div class="hero" style="background-image: url('${data.heroImage}')">
                    <div class="hero-content">
                        <h1>${data.title}</h1>
                        <p>${data.tagline}</p>
                    </div>
                </div>

                <div class="quick-info">
                    <div class="info-item">
                        <i class="fas fa-users"></i>
                        <h3>Population</h3>
                        <p>${data.info?.population || 'N/A'}</p>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-language"></i>
                        <h3>Language</h3>
                        <p>${data.info?.language || 'N/A'}</p>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-money-bill-wave"></i>
                        <h3>Currency</h3>
                        <p>${data.info?.currency || 'N/A'}</p>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-clock"></i>
                        <h3>Time Zone</h3>
                        <p>${data.info?.timezone || 'N/A'}</p>
                    </div>
                </div>

                <div class="content">
                    <section class="section">
                        <h2>About ${data.title.split(',')[0]}</h2>
                        <p>${data.about}</p>
                    </section>

                    <section class="section">
                        <h2>Must-See Attractions</h2>
                        <div class="highlights">
                            ${data.attractions.map(attraction => `
                                <div class="highlight-card">
                                    <img src="${attraction.image}" alt="${attraction.name}">
                                    <div class="content">
                                        <h3>${attraction.name}</h3>
                                        <p>${attraction.description}</p>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </section>

                    <section class="section">
                        <h2>Local Experiences</h2>
                        <div class="highlights">
                            ${data.experiences.map(experience => `
                                <div class="highlight-card">
                                    <img src="${experience.image}" alt="${experience.name}">
                                    <div class="content">
                                        <h3>${experience.name}</h3>
                                        <p>${experience.description}</p>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </section>

                    <section class="section blogs-section">
                        <h2>Traveler Stories</h2>
                        <div class="blog-grid">
                            <!-- Default blog -->
                            <div class="blog-card">
                                <div class="blog-image">
                                    <img src="blog1.jpg" alt="Blog 1">
                                </div>
                                <div class="blog-content">
                                    <div class="blog-meta">
                                        <span><i class="fas fa-user"></i> John Doe</span>
                                        <span><i class="fas fa-calendar"></i> 2 days ago</span>
                                    </div>
                                    <h3>My Amazing Experience in ${data.title.split(',')[0]}</h3>
                                    <p>The culture, the food, and the people made this trip unforgettable...</p>
                                </div>
                            </div>
                            <!-- User submitted blogs -->
                            ${blogsHTML}
                        </div>
                        <div style="text-align: center;">
                            <a href="#" class="add-blog-btn" onclick="openBlogModal()">
                                <i class="fas fa-plus"></i> Share Your Story
                            </a>
                        </div>
                    </section>
                </div>
            `;

            document.getElementById('destination-content').innerHTML = html;
            document.getElementById('loading').style.display = 'none';

            // Animate sections on scroll
            const sections = document.querySelectorAll('.section');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                    }
                });
            }, { threshold: 0.1 });

            sections.forEach(section => observer.observe(section));

            // Load weather data
            loadWeather(data.title);
        }

        // Check authentication state
        function checkAuthState() {
            const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
            const authButton = document.getElementById('authButton');
            const userProfile = document.getElementById('userProfile');
            const userName = document.getElementById('userName');
            const userPhoto = document.getElementById('userPhoto');

            if (isLoggedIn) {
                authButton.style.display = 'none';
                userProfile.style.display = 'block';
                userName.textContent = localStorage.getItem('userName') || 'User';
                userPhoto.src = localStorage.getItem('userPhoto') || 'default-avatar.png';
            } else {
                authButton.style.display = 'block';
                userProfile.style.display = 'none';
            }
        }

        // Initialize page
        window.onload = function() {
            loadDestination();
            checkAuthState();
        }

        // Weather API integration
        async function loadWeather(city) {
            const apiKey = 'YOUR_WEATHER_API_KEY';
            try {
                const response = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=metric`);
                const data = await response.json();

                document.getElementById('weatherWidget').innerHTML = `
                    <h3>Current Weather</h3>
                    <p>${Math.round(data.main.temp)}°C</p>
                    <p>${data.weather[0].description}</p>
                `;
            } catch (error) {
                console.error('Error fetching weather data:', error);
            }
        }

        // Modal functionality
        function openModal(imageSrc) {
            const modal = document.getElementById('imageModal');
            const modalImg = document.getElementById('modalImage');
            modal.style.display = 'flex';
            modalImg.src = imageSrc;
        }

        document.querySelector('.close-modal').onclick = function() {
            document.getElementById('imageModal').style.display = 'none';
        }

        // Blog Modal Functions
        function openBlogModal() {
            if (!isUserLoggedIn()) {
                // Show login prompt modal
                const loginPrompt = document.createElement('div');
                loginPrompt.className = 'modal';
                loginPrompt.style.display = 'flex';
                loginPrompt.innerHTML = `
                    <div class="modal-content" style="max-width: 400px; text-align: center;">
                        <h2 style="margin-bottom: 20px;">Login Required</h2>
                        <p style="margin-bottom: 30px;">Please log in to share your travel experience.</p>
                        <a href="login.html" class="add-blog-btn" style="background: #5e9ced; color: white; text-decoration: none; padding: 10px 20px; border-radius: 5px; display: inline-block;">
                            Login Now
                        </a>
                    </div>
                `;
                document.body.appendChild(loginPrompt);

                // Close login prompt when clicking outside
                loginPrompt.onclick = function(event) {
                    if (event.target === loginPrompt) {
                        loginPrompt.remove();
                    }
                };
                return;
            }
            document.getElementById('blogModal').style.display = 'flex';
        }

        // Function to delete a blog
        function deleteBlog(blogId) {
            if (!confirm('Are you sure you want to delete this blog?')) return;
            
            const city = getUrlParameter('city');
            const blogs = getBlogs(city);
            const updatedBlogs = blogs.filter(blog => blog.id !== blogId);
            localStorage.setItem(`${city}_blogs`, JSON.stringify(updatedBlogs));
            loadDestination();
        }

        // Function to edit a blog
        function editBlog(blogId) {
            const city = getUrlParameter('city');
            const blogs = getBlogs(city);
            const blog = blogs.find(b => b.id === blogId);
            
            if (!blog) return;

            const modal = document.getElementById('blogModal');
            const form = document.getElementById('blogForm');
            
            // Pre-fill the form
            form.querySelector('input[placeholder="Title"]').value = blog.title;
            form.querySelector('textarea').value = blog.content;
            
            // Show existing images
            const photoPreview = document.getElementById('photoPreview');
            photoPreview.innerHTML = '';
            blog.images.forEach(img => {
                const imgContainer = document.createElement('div');
                imgContainer.style.position = 'relative';
                
                const imgElement = document.createElement('img');
                imgElement.src = img;
                
                const removeBtn = document.createElement('button');
                removeBtn.className = 'remove-photo';
                removeBtn.innerHTML = '×';
                removeBtn.onclick = function() {
                    imgContainer.remove();
                };

                imgContainer.appendChild(imgElement);
                imgContainer.appendChild(removeBtn);
                photoPreview.appendChild(imgContainer);
            });

            // Update form submission for editing
            form.onsubmit = function(e) {
                e.preventDefault();
                
                const updatedBlog = {
                    ...blog,
                    title: form.querySelector('input[placeholder="Title"]').value,
                    content: form.querySelector('textarea').value,
                    images: Array.from(document.querySelectorAll('#photoPreview img')).map(img => img.src),
                    editedAt: new Date().toISOString()
                };

                const blogs = getBlogs(city);
                const updatedBlogs = blogs.map(b => b.id === blogId ? updatedBlog : b);
                localStorage.setItem(`${city}_blogs`, JSON.stringify(updatedBlogs));
                
                loadDestination();
                modal.style.display = 'none';
                form.reset();
                photoPreview.innerHTML = '';
                
                // Reset form submission handler
                form.onsubmit = null;
            };

            modal.style.display = 'flex';
        }
    </script>
</body>

</html>